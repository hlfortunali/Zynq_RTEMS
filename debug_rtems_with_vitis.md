# Tools 
    1. Ubuntu22.04.2
    2. Vitis2022.2
    3. RTEMS6
    4. Zynq board (AX7010 from Alinx company)
    
    ***
    
# Debug use Xilinx Vitis
    1. build the RTEMS app following the official guide, then you will get hello.exe(for example)
    2. Create a Vitis project, we call it hello project. 
    3. Test the vitis project and debug it, if it can successfully output "hello world" in serial console,    
        this means the project and debug configure are both ok.   
        Note: the debug type select "Single Application Debug", without GDB.   
    4. Set the debug configure for hello project in Vitis. Just change the Application section.    
        ``` Debug configuration --> Application --> Browse --> select the RTEMS app hello.exe. ```   
        Note : change the ".elf" to ".exe" at the right bottom of the file select window.
    5. Start debugging RTEMS program just like debugging the Vitis hello project. 
    6. Creating a c project using Makefile project template in vitis and set the project location in path of    
        "$RTEMS_HOME/src/rtems", so that the source code can be followed when debuging RTEMS program.    

***
# Build rtems application with Vitis
    1.  Select a xsa file generated by Vivado and create a Vitis project with xsa file.    
        ï¼ˆFile -> new -> application project -> next -> selct xsa or load new xsa file .....)   
    2. Add the rtems test hello files, including hello.c and init.c.
    3. Copy the arm-rtems6 folder to the created project path.   
       Note: the arm-rtems6 folder is needed. It contains lib, include , bin and xilinx_zynq_zedboard bsp folder.   
             The bin folder can be deleted.   
   ![picture](https://github.com/hlfortunali/Zynq_RTEMS/blob/main/img/project_structure.png?raw=true)   
   
   
    4. Set the tool chain as Cross ARM GCC in "Tool Chain Editor"  page.
    5. In "C/C++ Build -> Settings" page, under label of "Toolchains" set prefix as "arm-rtems6-", and add the   
       arm-rtems6-gcc path to "Toolchain path" input box, the path as : "...../quick_start/rtems/6/bin".
   ![picture]( https://github.com/hlfortunali/Zynq_RTEMS/blob/main/img/toolchains.png?raw=true)
   
   
    6. In "C/C++ Build -> Settings" page, under label of "Tool Settings", add include path of "arm-rtems6/include"
       and "arm-rtems6/xilinx_zynq_zedboard/lib/include", and also any other user created include path.
    7. Following step 6, selecting "Cross ARM C Compiler --> Miscellaneous" add other compiler flags :   
       -O0 -g3  -std=gnu11 --save-temps -v  -std=c11 -march=armv7-a -mthumb -mfpu=neon -mfloat-abi=hard -mtune=cortex-a9 -MMD  -qrtems -Wl,--gc-sections   
   ![picture](https://github.com/hlfortunali/Zynq_RTEMS/blob/main/img/c_compiler_config.png?raw=true)    
   
   
    8. Following step 7, under "Cross ARM C Linker" page, uncheck all other checkbox. Just adding lib path of the    
       "xilinx_zynq_zedboard/lib"   
   ![picture](https://github.com/hlfortunali/Zynq_RTEMS/blob/main/img/linkder_set.png?raw=true)   
       
    
    
# Problem
    Cannot read symbol data. Invalid abbreviation table. Error reading DWARF data When debuging following   
    the above steps, this error may appear. The reason is that RTEMS gcc version and the Xilinx Vistis GDB   
    version are not compatiable. The solution is upgrade your Vitis version or downgrade RTEMS version.   
    RTEMS6 and Vitis2022.2 can work. RTEMS5 and Vitis2020.1 can also work. Other versions are not tested.      

